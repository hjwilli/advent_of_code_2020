import groovy.transform.ToString 
import groovy.transform.AutoClone

N = 0
E = 1
S = 2
W = 3

def input = getExample()
//def input = getInput()


def (tiles, res1) = part1(input)
println "res1: $res1"


def res2 = part2(tiles)
println "res2: $res2"


// ---
def part1(def input) {
	def tiles = parseTiles(input)

	int dim = Math.sqrt(tiles.size()) // dim of picutre
	println "tiles: ${tiles.size()} dim:${dim}"

	def res = picSolver(tiles, dim)

	println "got res: "//$res"
	println res*.id
	println res*.rot
	println res*.flip

	def corners = [0, dim*dim - 1, getIdx(0, dim-1, dim), getIdx(dim-1, 0, dim)]

	Long prod = 1
	corners.each { idx ->
		//println "corner: ${res[idx].id}"
		prod = prod * (res[idx].id as Long)
	}
	
	return [res, prod]
}

def part2(def tiles) {
	int dim = Math.sqrt( tiles.size() ) // dim of picutre

	def (picTile, monster) = buildImage(tiles, dim)

	return findMarkMonsters(picTile, monster)
}

// parses the input to a list of Tile objects
def parseTiles(def input) {
	def tiles = []

	def data = []
	def id = 0
	input.eachLine { line ->
		if (line.trim().size() == 0) {
			def t = new Tile(id.toLong(), data)
			tiles << t
			data = []
		}
		else if (line.contains("Tile")) {
			def res = ( line =~ /Tile (\d+):/)
			id = res.findAll().first()[1]
		}
		else {
			data << line.trim()
		}
	}

	return tiles
}


/*
part 2
build the final image from a list of correctly oriented tiles

returns a Tile with the final image and the regex pattern to identify a monster in an image of this size
*/
def buildImage(def tiles, def dim) {
	
	def picArray = []
	
	for (tileRow in (0..(dim-1))) {
		for (picRow in (1..8)) {
			row = ""
			for (tileCol in (0..(dim-1))) {
				def tile = tiles[getIdx(tileCol, tileRow, dim)]
				tile.getPicRow(picRow).each { c -> row += c}
			}

			picArray << row
		}
	}

	def gap = picArray.first().size() - 20
	//def monster = "..................#..{$gap}#....##....##....###.{$gap}.#..#..#..#..#..#...."
	// group regex, because the '#' groups will be replaced with marker values and the other groups should not change
	def monster = "(..................)(#)(..{$gap})(#)(....)(##)(....)(##)(....)(###)(.{$gap}.)(#)(..)(#)(..)(#)(..)(#)(..)(#)(..)(#)(....)"

	return [new Tile(999, picArray, picArray.first().size()-1), monster]
}

/* Part 2
Given a tile that represents the final image, and a regex string that represents a monster,
returns the number of "#" that are not part of a monster

Internally uses x/X instead of '#' so monster pattern can be matched in a case insensitive way
and characters that are part of the pattern can be marked by capitialization 
*/
def findMarkMonsters(def tile, def monster) {
	// regex group replacement; when we find a monster regex match, how to replace
	def rep = '$1$2X$4X$6XX$8XX$10XXX$12X$14X$16X$18X$20X$22X$24'
	monster = monster.replaceAll("#", "x")

	println "searching for monster:"
	println monster

	//tile.printPic()

	// orient the image till we see monsters
	for (rot in (0..3)) {
		for (flip in [false, true]) {
			tile.flip = flip
			tile.rot = rot

			def testStr = tile.getFlattenedData().replaceAll("#", "x")

			def matcher = ( testStr =~ /(?i)$monster/)
			def count = matcher.findAll().size() 
			if (count > 0) {
				println "found at least $count monsters"
				tile.printPic()

				println testStr

				// replace on monster at a time to allow for possible overlapping monsters
				for (i in (0..testStr.size()-20)) {
					testStr = testStr.replaceFirst(/(?i)^(.{$i})$monster/, rep)
				}

				println "== after:"
				println testStr

				return testStr.findAll("x").size()
			}
		}
	}

	return 0
}


/*
part 1

Recursive solver to get the location and orientation (rotation, reflection) of a list of tiles
such that all the edges match

returns a list of correctly oriented tiles
the method getId(...) can be used to go from the x,y coordinates of a tile to it's list index 
*/
def picSolver(def remTiles, def dim, def pic = []) {
	//println "ps \n\ttiles: ${remTiles*.id} \n\tpic: ${pic*.id} ${pic*.flip} ${pic*.rot}"

	for (def tile in remTiles) {
		for (rot in (3..0)) {
			for (flip in [false, true]) {
				def testTile = tile.clone()
				testTile.flip = flip
				testTile.rot = rot

				if (isValidTilePlace (testTile, pic, dim)) {
					def testPic = pic + testTile
					
					// success
					if ((testPic.size()) == dim * dim ) {
						return testPic
					}

					def res = picSolver (remTiles - tile, dim, testPic)
					if (res) return res // success!
				}
			}
		}
	}
	return false
}

// part 1
def isValidTilePlace(tile, pic, dim) {
	int x = (pic.size() ) % dim
	int y = Math.floor((pic.size() ) / dim)
	def idx

	//println "\t\t\tisValid [$x, $y] - ${tile.id} f:${tile.flip} r:${tile.rot}"

	// check N
	idx = getIdx(x, y-1, dim)
	if (idx >= 0 ) {
		if (tile.getSide(N) != pic[idx].getSide(S) ) return false
	}

	// check w
	idx = getIdx(x-1, y, dim)
	if (idx >= 0 ) {
		if (tile.getSide(W) != pic[idx].getSide(E) ) return false
	}
	
	return true
}

def getIdx(x, y, dim) {
	if ((x < 0) || (y < 0) || (x >= dim) || (y >= dim)) return -1
	return x + (y * dim)
}



@AutoClone
@ToString
class Tile {
	def rawData
	def data 
	def tileSize

	def id // tile id
	def rot = 0 // rot to right: 0-3
	def flip = false // horizontal flip


	static N = 0
	static E = 1
	static S = 2
	static W = 3

	def Tile(id, rawData, tileSize = 9) {
		this.id = id
		this.rawData = rawData
		this.tileSize = tileSize

		this.data = [] + rawData*.toCharArray()
	}

	// part 1
	// get the edge of the tile after any transforms are applied
	// N/S is read from left to right
	// E/W is read from top to bottom
	def getSide(def val) {
		def s = this.tileSize
		def base = []
		if (val == N) base = (0..s).collect{ [0, it] }
		if (val == E) base = (0..s).collect{ [it, s] }
		if (val == S) base = (0..s).collect{ [s, it] }
		if (val == W) base = (0..s).collect{ [it, 0] }

		return base.collect { 
			return this.getTransPixel(it)
		}
	}

	// part 2
	// get a row of the picture without the edge, after transforms are applied
	def getPicRow(def r) {
		def base = (1..(this.tileSize - 1)).collect { [r, it] }
		return base.collect {
			this.getTransPixel(it)
		}
	}

	// part 2
	// get the tile data (after image transforms) as a single string. 
	def getFlattenedData() {
		def str = ""

		for (y in 0..(this.tileSize )) {
			for (x in 0..(this.tileSize )) {
				str += this.getTransPixel([y,x])
			}
		}

		return str
	}

	// display the picture wrt transforms (includes edge)
	def printPic() {
		println "====="
		println "rot: ${this.rot} flip:${this.flip}"
		for (y in 0..(this.tileSize )) {
			for (x in 0..(this.tileSize )) {
				print this.getTransPixel([y,x])
			}
			print "\n"
		}
		println "====="
	}

	// get the pixel value after image transformations
	def getTransPixel(def base) {
		def (x, y) = this.transCoords(base[0], base[1]) 

		//println "transPixel $base -> $x, $y; r:${this.rot} f:${this.flip}"
		return this.data[x][y] 
	}

	// get pixel coordinates after image transforms
	def transCoords(def x, def y) {
		def l = this.tileSize

		// flip horizontaly then rotate
		if (this.flip) { y = l - y}

		if ( this.rot == 1 ) return [ (l - y), x ]
		if ( this.rot == 2 ) return [ (l - x), l - y]
		if ( this.rot == 3 ) return [ y, l - x]
		return [ x, y ]
	}
}


// ---inputs
def getExample2() {
	def input = '''\
Tile 2311:
..........
##########
##########
##########
##########
##########
##########
##########
##########
##########

Tile 2312:
..........
##########
##########
##########
##########
##########
##########
##########
##########
##########

Tile 2313:
..........
##########
##########
##########
##########
##########
##########
##########
##########
##########

Tile 2314:
..........
##########
##########
##########
##########
##########
##########
##########
##########
##########

'''
	return input
}


def getExample() {
	def input = '''\
Tile 2311:
..##.#..#.
##..#.....
#...##..#.
####.#...#
##.##.###.
##...#.###
.#.#.#..##
..#....#..
###...#.#.
..###..###

Tile 1951:
#.##...##.
#.####...#
.....#..##
#...######
.##.#....#
.###.#####
###.##.##.
.###....#.
..#.#..#.#
#...##.#..

Tile 1171:
####...##.
#..##.#..#
##.#..#.#.
.###.####.
..###.####
.##....##.
.#...####.
#.##.####.
####..#...
.....##...

Tile 1427:
###.##.#..
.#..#.##..
.#.##.#..#
#.#.#.##.#
....#...##
...##..##.
...#.#####
.#.####.#.
..#..###.#
..##.#..#.

Tile 1489:
##.#.#....
..##...#..
.##..##...
..#...#...
#####...#.
#..#.#.#.#
...#.#.#..
##.#...##.
..##.##.##
###.##.#..

Tile 2473:
#....####.
#..#.##...
#.##..#...
######.#.#
.#...#.#.#
.#########
.###.#..#.
########.#
##...##.#.
..###.#.#.

Tile 2971:
..#.#....#
#...###...
#.#.###...
##.##..#..
.#####..##
.#..####.#
#..#.#..#.
..####.###
..#.#.###.
...#.#.#.#

Tile 2729:
...#.#.#.#
####.#....
..#.#.....
....#..#.#
.##..##.#.
.#.####...
####.#.#..
##.####...
##..#.##..
#.##...##.

Tile 3079:
#.#.#####.
.#..######
..#.......
######....
####.#..#.
.#...#.##.
#.#####.##
..#.###...
..#.......
..#.###...

'''

	return input
}

def getInput() {
		def input = '''\
Tile 2729:
.....#####
##..##.#.#
......#.##
#....#.#.#
#......##.
#...#..#.#
#.........
.......##.
#.#..#....
#.#.###..#

Tile 3673:
##.....###
.....##...
#.......#.
..#..##.##
...##.#...
...#......
..#...#..#
..........
##..#.#..#
####.#.#.#

Tile 2797:
#######..#
###..#.#.#
#...#.....
....#...#.
....#...#.
#...##....
....#....#
#..#......
.#........
#.#.....##

Tile 3779:
....###..#
#..#......
...##.....
#.#..#...#
..##.#....
##.##....#
#.........
.....#...#
#.###...#.
.#####.#.#

Tile 3217:
...###.###
#....#..##
#.......#.
......#..#
#...##..##
##..#....#
#...####.#
..#..##...
..#.##...#
#..#.###..

Tile 3137:
.#..#.#.#.
#.......#.
###...#..#
#.#...#...
.....#.#.#
..#..#....
#...#.#.##
..#......#
..#...#...
###.##.##.

Tile 2857:
...##..##.
.........#
#........#
.#.....#..
#..#..#...
#...#.#.#.
##....####
#.....##.#
...#..#...
..####....

Tile 1831:
#.##..####
.#.#.#...#
#..##.....
#..#....#.
#.##......
...#....#.
......#..#
..........
####..#...
####.###..

Tile 2423:
...#.##..#
#...##...#
##......##
...#.#....
#.....#...
#.....#..#
.#..####..
.##...#.##
..##.#..#.
#..#..####

Tile 3221:
..#.##.###
#.#.......
#...#....#
...#...#..
#..#.#...#
....###..#
.........#
.........#
#...#.##.#
##..##.###

Tile 2707:
.##.#.#...
.#.##..#.#
#...#.....
#.#.......
#...#.....
..#......#
.......###
..#.#...#.
#.#.......
..#...#.##

Tile 3041:
#.####...#
##.....#..
..#.#..###
#.###..###
.#.#.....#
#....#....
..##......
.###....#.
###.##.#..
#####.##.#

Tile 1627:
.###..#..#
.#..#.##..
##...#...#
#....###.#
..#......#
#....#..#.
#.##.....#
.##..#...#
..#...#..#
...#.###.#

Tile 1237:
...##..###
#.#......#
#.##..#..#
#.#.....#.
#....#...#
...#....#.
#.#....#..
.##.......
..#..#..##
.###.#.#.#

Tile 1187:
#...###...
#.###.#...
..##...#..
##.....#..
.....#...#
#.....#...
....#..#.#
.........#
.#...#....
.####.#.##

Tile 1361:
.#.##..###
......#..#
....#.#..#
.#.......#
#.#.....##
.#.#..##..
##.##....#
#.##..#.##
#.#......#
.##..##...

Tile 2087:
###.#.....
.#...#....
.#..#.....
####.....#
...#.....#
...##.....
##..###..#
....##..#.
.#.####...
...#..####

Tile 1129:
###.#.#...
#.##..###.
.....#....
#...#..#..
#.#.###.#.
.##..###..
#...##..##
.....#...#
#........#
...#..####

Tile 1093:
.....##.##
#.......##
.##.#.##.#
#.#..####.
#....#....
###......#
#.#.......
#..#.....#
#..#.#.#..
#..#....#.

Tile 3049:
##...#..##
#........#
#......#..
.....#.###
#........#
#..#.#....
#........#
....#.....
..##.....#
##.#..##.#

Tile 2399:
##...#.##.
...#......
#.#.##...#
##.......#
#.........
#.........
.....##..#
#....#....
.........#
.....##.##

Tile 3371:
##....##..
.....##...
##.##.#.##
......###.
##..####.#
..#..##..#
.....#...#
#..#..#..#
.##.#...##
.####..###

Tile 3343:
#......##.
.##.#.#..#
#...#.##.#
.##..##...
.#.#....##
##.#..#...
#....#.#.#
.....##..#
#.....##.#
.##.#....#

Tile 2393:
.####.#.#.
.#..##....
.##..#.#..
#....#....
#...##.##.
.#...#...#
#..#......
....#.##.#
#....##..#
.#..###.#.

Tile 1621:
##..###..#
##.....#..
#.#....###
.##..#.#.#
#.........
#......#.#
#.#.......
.#........
#.#......#
....####.#

Tile 3181:
#...#.####
...#.#...#
..........
....#..#..
##........
......####
#.#..#..##
..........
..#....##.
...###...#

Tile 2441:
.#..#..#..
#....##...
.#...#.#..
#...##..#.
...#..###.
.....#.#.#
#...#...#.
#...##...#
#......#.#
#...##..##

Tile 2389:
.#...#.#..
.........#
..........
###.......
....#.#...
....#.##..
#.....##.#
..#.......
#.##.....#
#...###.##

Tile 1847:
#.###.#..#
#.#...#.#.
#.......##
#...#..#.#
..###.#..#
...##....#
#....#...#
##...#...#
.###...#..
.#.#.####.

Tile 1871:
.###.##...
#.......#.
#.......#.
#.....#..#
..##...#.#
##.....###
.....###..
#....###.#
##.##..#..
###...####

Tile 3877:
#.....#.#.
..##....##
###......#
#...###...
.##...##..
.#...#....
..#....#.#
#.........
...#..#...
#..###.#..

Tile 3517:
###..##.#.
...###...#
..#......#
.#.#...#.#
....#.##.#
#...#..#..
...##....#
#.....###.
.#..##...#
........##

Tile 2609:
#...#..###
.........#
...#.#.#..
#####..#.#
#.#....#.#
.......#..
###..#...#
..........
.#...#....
#.#.....#.

Tile 3001:
..#...#...
#........#
#..#.....#
.#.#.#...#
#..##.....
#.....##..
#......#.#
..##...#..
.#..#.##.#
#.##.#####

Tile 3067:
#.#.#.###.
##....#...
.#..#.....
....#.....
.###..#.##
.....#....
.#...##...
.#.#.##..#
.....#...#
#.#.#....#

Tile 1583:
####....#.
##.#....##
##..#....#
#...#.##..
....##....
###.##...#
#..#..##.#
.###.....#
.#.##....#
..#.####.#

Tile 1741:
#.#.#####.
....#.....
#.#......#
..##...###
......#...
#........#
..##...###
#.#...####
####.#....
.#..#.#.#.

Tile 1933:
#####..###
#...#..#..
.##...#..#
.......###
##........
..#...##..
.....#..##
#....#....
#.....#.#.
....##..#.

Tile 3697:
#..#.#####
...#..##..
#.....#...
.#..#.##..
......#...
#......#..
##....#..#
.##.....#.
#.#..#....
#..##...##

Tile 1429:
##.....#..
###.#...##
#.....#..#
#...###..#
....#.....
##.#...#..
#....##...
.##.#..#..
..#.#.#..#
#.#.###...

Tile 1721:
##..#.#..#
...#.#....
##...#.#.#
##..#....#
.##.#....#
#..#.#....
#.##.#....
##.....#..
..#..###..
..###.#..#

Tile 1867:
.##.####.#
#.##....#.
#....#....
##..#..#..
##.#..#..#
.......#..
##........
..#...##.#
....#..#.#
..###.#.##

Tile 2143:
##..##.#..
#.........
..#.#..###
.#.#..#...
.#######..
....#....#
##.##.#..#
......##..
..#.#.##.#
..#...#..#

Tile 1657:
......#..#
#.##..###.
.#.....#.#
.#......##
#.####...#
...#.#....
#.#....###
#.....##.#
....#....#
#..#..#...

Tile 2719:
#####..#..
#.....###.
.##....###
..#.##....
#..##.....
.......###
#.....#...
..#...##..
.#..##.#.#
..####....

Tile 2803:
###..###..
.#..#...##
#.....#...
#.#.###...
##..#....#
#...#..#.#
...##...##
......####
.......##.
.###.#..##

Tile 3929:
.#.#####.#
##...#....
...#.#.#.#
.#......#.
.......#..
##....##.#
...#...#..
.......###
.........#
..##..##.#

Tile 1321:
.#.#...#.#
.......#..
...#.####.
#.........
..#.#.#.##
##....#...
..........
#.##...#..
#....#...#
#######.##

Tile 1153:
.#...#.###
#........#
#...#...#.
#.....#..#
#........#
#.#.....##
.....##...
#..#...#..
#.....#..#
##.#..##.#

Tile 3803:
#.####...#
#.##..#...
##..#.....
.##.....#.
..#...#...
#.##.#.#..
##.....#.#
##.#..#..#
##..#..#..
....##..##

Tile 2791:
.#....####
#.....#...
#.#.##...#
..#.#.#..#
##..#....#
#....#..##
...#.##..#
......#..#
#....#.#..
#.###.#.#.

Tile 3529:
.#...#...#
.....#..#.
#........#
.........#
.##.##.#..
##.......#
#...#...##
.......#..
...#.##..#
#.#####...

Tile 3257:
####.#.###
.##...##..
..#....#..
..###..#.#
#.#..#...#
.......##.
##.##.####
.....##..#
#....##...
###..###.#

Tile 1531:
#.#...#...
.........#
##...#...#
##......##
...#.....#
#.#.###..#
#....#...#
.#....#.#.
#...#....#
#########.

Tile 3413:
#...#.....
...###..##
##..##....
.#..##....
#..#.#.#..
...#.....#
....#..#.#
...#....##
...#.#...#
#.###..#.#

Tile 1117:
#.#.##...#
.........#
.........#
#....#..##
#.#.##..#.
#......#..
#.#.#.#...
#..#.....#
......#.#.
..##.#..#.

Tile 1499:
.#####..##
...#...###
.........#
#..#.....#
##......##
#.......#.
#......##.
#####.....
.#.....#..
.###..####

Tile 1787:
.######..#
#....#.#.#
........#.
#.....#...
..........
..#..#.###
#.#..#...#
.#.#.#####
.....#.#.#
##.#.##.##

Tile 1949:
##..####.#
##.#......
.........#
....#..#.#
.#...##..#
....#..#..
#.....#...
##....#..#
.....#..#.
.#.#.#.#.#

Tile 2161:
####.#..#.
#.......#.
.##....#.#
.###..#..#
#.#..#....
#..#..#...
#...#.#.##
#...#.##.#
###....#..
#...#.##.#

Tile 2953:
#.#...#.##
#.#.#...##
#.......##
.........#
#..#.....#
..#.##.#..
..#.###..#
##.....#..
......#...
###.#.#.#.

Tile 1039:
##..###..#
#.....#...
#....#.#.#
#...#...##
##.......#
#.....#..#
...#.....#
.#.###...#
.........#
#.#..#####

Tile 2027:
##.####..#
..#.....#.
#.#.##...#
.#.......#
.....#.###
#........#
.#.#.....#
#.#...#.#.
#.###...#.
..##.##...

Tile 1889:
..####.##.
#....#.#.#
##.#..##.#
#..#...###
##...#..##
#..##...#.
#..#.###.#
#.###.#...
##...##...
##.##..###

Tile 3557:
##.##.#...
.....#.#.#
#.#..#....
##..###..#
....##...#
....#....#
.#..#...#.
.#.#.##..#
###..#...#
#.#.#..#..

Tile 2549:
....#..#..
#..#..#.##
.....#...#
#..##.#.#.
.#.##....#
.#..#....#
.#.#...#..
##.....#..
..........
#....#...#

Tile 1543:
.##.###.##
....#.#..#
#.........
...#.#...#
#.......#.
.....##...
....#.....
..###.#..#
###..#....
###.#.###.

Tile 2417:
.#....#.#.
#.#..###.#
....##....
##.....#.#
..........
#....#..##
.....#...#
#.#......#
#........#
###..##..#

Tile 3541:
.##..###..
##...##.##
##..#....#
.........#
...#.#....
...#.....#
#..#...#..
..........
.#..##.#.#
..##.#..##

Tile 1931:
.##...##.#
...#.....#
#...###...
#.......#.
#.......##
.#.#.#....
##..#....#
##...#..##
..........
....#.#.#.

Tile 2833:
.#...#....
#..####...
.#...##.##
.#.......#
#.#...#..#
..#.....##
#......#..
##....#..#
......#..#
##..##...#

Tile 3301:
###.#.####
..###.##..
..........
.#....##..
#.#..##...
..#....#.#
.#.#..#...
#.#..#...#
....#.##.#
......##.#

Tile 3671:
##.#..#...
.##....###
##.....#..
###.#.#.#.
....#...##
#.....#..#
#.#......#
.......###
#..#.....#
...#.###.#

Tile 1609:
..##..#.##
###..##...
.#..#..#..
#....#.#..
#..#.##.#.
#.......#.
.....#...#
#.....#..#
......##..
###..##...

Tile 2957:
###..#####
###.......
#..#.....#
#.#......#
#.....#..#
#.#.......
###.#..#.#
.#.#.##.#.
###.#.#...
...##.####

Tile 2467:
##.#.#.#..
........#.
....#...#.
#.......#.
..#...#..#
...#.#...#
#...###.##
#.##.#.#..
.#...##...
..#.####..

Tile 1907:
###..###.#
#...#....#
...#..#..#
.......#.#
........##
##...#..##
#..#.##...
#....#.#.#
#......###
###.....#.

Tile 2251:
##...#..##
#..#.##..#
..#.#..###
##........
.......#..
.#..#.#...
#..#.#..#.
#..#......
###.#...##
#.###.##..

Tile 2657:
.#..##..##
##.#....##
#.#...#...
#..#......
#........#
#.........
..#....#..
#.........
#.........
##.###.###

Tile 2671:
#.#.#.##.#
.#..#..#.#
.#.......#
#...#..#..
.....###.#
#.....#..#
#.#......#
#........#
#....#....
####.#..#.

Tile 3121:
..#..#...#
#....#...#
....###.#.
#........#
..####....
.......###
#..#.####.
##.#.###.#
.####..#..
#.#...#..#

Tile 1021:
#####.####
#....#...#
####....#.
#......#..
##..#...##
##.#.#..##
#.....#.#.
#.#...##.#
.#......##
.#.##...#.

Tile 1019:
...#.##..#
#........#
.........#
##....#...
#..#..##.#
........#.
.....##...
#..##....#
#.....#.#.
.##.####..

Tile 2099:
#.##..###.
#..#......
#.##...#.#
...##..##.
#...#.....
.#.....#.#
.....#..#.
.....##...
#...##..##
##.#####.#

Tile 1297:
.###..####
##...###.#
..#..##..#
#...#.....
...#....##
#....#...#
###.##.#..
#.........
......#.##
..#.##..#.

Tile 1993:
####..#.#.
.#.#.#....
#...#.##.#
#.....#..#
..#..#.#..
#.#.#...#.
.#..#...#.
##...##..#
..#...##.#
#..#.##.#.

Tile 2617:
..#.#.#.##
.##.####..
#.#..####.
....#.#..#
#.#.#.#.##
...#......
##......##
.#...#.#..
#..#...#.#
.###.#..#.

Tile 1009:
##.#....#.
#.#.#...#.
#.#....#..
......#..#
####......
....#...##
......#..#
.......#..
##.....#..
..#...#.#.

Tile 2203:
#.#.###.##
#.#...##.#
....#.##.#
#..#......
.#....#..#
......#...
##.##....#
#...#...#.
##.##....#
#..#..#.##

Tile 3467:
....##.##.
#...#..#..
##....#...
#.......##
#.........
...#....##
#...#.....
##.#.#.#.#
...##.#..#
#...#.....

Tile 3617:
##..####.#
#...#.#..#
.......#.#
..........
.......#..
...#...###
#.#.......
#.........
.....##...
##.#.###..

Tile 1601:
.#..####.#
.....##...
#.....##.#
#...###..#
##....#...
##......#.
#.#.....#.
##.......#
#.......##
..##.#.#..

Tile 2699:
.#...#...#
#.##...##.
..........
#.##..#.#.
...#..#..#
...#.##..#
#.#..#..##
.#...###..
.#.......#
##..###.##

Tile 1231:
#.....##..
#..#.....#
###..#.#.#
..######..
...##....#
#..#...#.#
.....#...#
#.##..####
..#.#.....
.###.##..#

Tile 3373:
###...#...
.##..#...#
.#.#.....#
........#.
....#.....
#....#....
##.....#.#
###.......
#......#.#
#.#..#####

Tile 1901:
##.##..##.
##...#..##
......#..#
.#.#......
#.###.#..#
##.#.#.#..
........##
#....#..#.
.....#...#
.#..##....

Tile 1213:
...#.#.#.#
#.##...#..
.#.##.####
.....####.
##.##....#
#..#...#..
....#.....
##........
##..##....
###...#...

Tile 3163:
#.....#.#.
###.#..#..
......#...
#..#.#....
##....#.#.
##.#..##..
#.##.#..##
.#........
.#...#....
.....#.##.

Tile 2053:
.###.#...#
#.....#...
#..#.#..##
##.......#
#..#....##
....###..#
#.#..#...#
#.##.#.#..
.#..#..#.#
#.......##

Tile 3229:
......#...
#...#....#
##....#..#
.#..#.##.#
..####.#.#
###.......
##....#...
#..#...#.#
........#.
.#.###.###

Tile 3271:
#....#.###
#.......#.
#......#..
.###..##.#
....#..#..
.....#..##
.#...#....
........##
.......##.
#..####.##

Tile 2003:
..#.#....#
.##..#...#
#.........
#.........
#.........
#.##...#..
#..#..##.#
.......#..
##.......#
..#####..#

Tile 3637:
##.##.####
....#.#..#
##.#...#.#
....###.##
..........
.##.###.#.
#.###.....
......#...
..##.....#
##.#######

Tile 3967:
#..#.####.
###..#....
#.........
#..#..#..#
#..#.....#
..#...#...
..###.#.#.
#..#.....#
.#......#.
...##.#..#

Tile 2621:
...##.###.
...#.....#
#.#.##....
#.#.......
##.#.#.#..
...#....##
.......###
..##....##
#.#..#....
#####...#.

Tile 3347:
####..##..
#.#.##....
...#.##...
....##.#.#
####...###
..##..#..#
......#..#
#....#.#..
#....##..#
.#.#.#...#

Tile 1319:
#..###...#
#..##.#..#
#........#
##...#.#.#
#.##....#.
.....#.#.#
#...#....#
.....#...#
#.........
.#.##.....

Tile 1279:
##.....###
##...#....
#....#..##
#...##...#
...#.###.#
.#........
#.....##.#
...#.....#
..###.....
#.#.#..##.

Tile 1861:
.##...#.#.
#....####.
..........
#.#...#..#
###.####..
#......#.#
.......#.#
#.#.#.#..#
##.....#.#
....##..##

Tile 2861:
.#.######.
..#.#..##.
#.##......
....#.#...
........##
#....##...
......#...
#.#.......
#.#....#..
#######..#

Tile 1879:
#..#.....#
#........#
#..#####..
#.#..#..#.
#........#
.#....##.#
.##.....##
...#.....#
.##......#
..###.##.#

Tile 1291:
......##..
.#.....###
...#.#....
#....#.#.#
###.......
....#.....
.#.#.#.#..
.#.##....#
#..#.#....
##..##..#.

Tile 1109:
#....##.##
#.##....##
..#......#
.........#
..#.##.#..
#........#
##.#.....#
##....#...
.......###
##...#.#.#

Tile 2333:
......#..#
##..####..
..#.......
#.........
#.#.##...#
#.........
#.......#.
#.##.#..##
.#..#..#..
###..##..#

Tile 2081:
####...#.#
.....#....
.....##..#
.#..#..#.#
#.........
..##.#...#
.......###
.#..#.....
#......##.
#.#.#.#.##

Tile 1489:
#..##.#..#
..#.#.#.#.
...#......
#........#
#.#.#.....
.#.#.#.#.#
#.##......
#.#.##.#.#
#.#......#
.#..#..#.#

Tile 3931:
##.###.#.#
#........#
#.....#..#
.###......
......##.#
#..#...###
..#......#
#..#......
#....##...
###.###.##

Tile 1249:
.###.###.#
#.##...###
...#.#....
#...#..#..
......#..#
#......###
##..#...#.
..##.....#
#..#.#....
##....####

Tile 2381:
#...#....#
.#...##..#
##...##..#
...#.#...#
#..##.#...
.##..#.##.
.....####.
#..#..##.#
##...##...
.##.######

Tile 1747:
.####..#.#
#........#
....#....#
#.....####
##..#.#..#
###.##..##
.##...#...
..##......
#....###..
.#####..##

Tile 2687:
#.#.....#.
.........#
#..#...#.#
..........
#......##.
..#...##..
##.##...##
##.#...##.
......#..#
.#.#....#.

Tile 1327:
.###.#####
.......#.#
#..#..#.#.
#...#..#..
.......#..
..#.#.....
#........#
.##....#..
..###.#..#
#..#.##.##

Tile 3727:
#.#..#...#
..#.#....#
.##.###.#.
#.........
##.#...#.#
##.#....##
.##...#...
......#..#
........#.
#....##.##

Tile 2341:
.##.#.####
...#....#.
.#.....#.#
.....#....
#.#.###.#.
##.##.....
#...#.....
..#.#..#..
........#.
#.##......

Tile 1439:
#..#.#..##
.......#..
....#..##.
..#..#.#..
.....#...#
.#..#.##..
#...#..#.#
#.#......#
.#..#.....
##.#...#.#

Tile 2351:
..###...##
#....###..
.#....#..#
.#...#....
.#.......#
..#....##.
#..#.....#
#.......#.
##..#..#.#
...#..##..

Tile 2269:
.#####...#
#........#
#.......##
#.#....#..
..##.....#
.#..#..#.#
##...##...
#......###
...#......
#.#.###.#.

Tile 2887:
.#.##.#.##
.#....#...
#.....#..#
#.##...#.#
#...#.#.##
##.##.#...
##.#.##..#
.#.##..#..
......#..#
.#.#.##...

Tile 3391:
.####....#
.#..#..###
....#...#.
...#..#.##
#....#..##
#...#..##.
#..####.#.
..####..##
..##.....#
...#.#..##

Tile 3533:
.#....#..#
#.........
..#..#..##
.#.##.#..#
#...#.....
......##..
...#.#.#.#
#.....##..
..........
##.##..#..

Tile 1637:
.#.#.#.##.
#.#.....##
.#....#...
##.......#
.##.###.##
##.#......
..#.....#.
.###...#.#
........#.
#.##...#.#

Tile 3323:
..#.#.#.#.
#.#.....#.
#.##..#.##
##.......#
#.#....#.#
.##......#
.#..#..#..
..#..##..#
...##.....
##.##.##.#

Tile 1559:
##.##.#..#
.....#.#..
#.#.####..
...#.#...#
##....#..#
#.##...#..
.#..##.###
....#..#..
.#.#.#.#.#
#....#..#.

Tile 2039:
..#.######
.#...#...#
###.#.....
##..###..#
.#...##...
..#..#...#
#.....#.#.
....#.....
.###.....#
..##.#.###

Tile 3677:
####......
.......#..
#.........
........#.
.....###.#
#...#.###.
##........
....##..##
.#....#...
.##..##.#.

Tile 1973:
#.###..##.
#.........
#......###
#.#...####
#.#..#.#.#
..#..#..#.
#..#.#.#.#
##.##..#..
#.###...##
##.#.##.#.

Tile 2309:
####..##.#
#..#..#..#
...#.#...#
#....###.#
##....#.#.
....##....
......#...
##..#.....
#....#..#.
.##.#....#

Tile 2237:
.##......#
#.#....##.
...###..#.
#.#....###
.....#...#
#.##.....#
#..#...#..
.#...#..##
#.#....##.
....#.#.#.

Tile 2663:
##..##.###
#..#..##..
#...##...#
#.#.#..#.#
#..#......
....#..#.#
...#...###
##........
##....#.#.
.#...##.#.

Tile 1571:
##.#.#...#
.##.##.###
........##
#.........
#.#...##..
#.......#.
##..#####.
#..#...##.
##......#.
..#..##..#

Tile 3011:
#.#.#...##
....##.#.#
#...##...#
#........#
.#....#...
......#...
#.#.#..#..
..#####...
#.###.....
.......#.#

Tile 3457:
##.##..#.#
###.##....
.#.#...#..
##.......#
.....#.##.
#.#.##.#.#
.###.#####
..#.......
.##.....##
....#.###.

Tile 1619:
#..#...#..
#.....#.#.
#..#..##..
.....#....
#.#...#...
.#..#....#
#....##.##
.....##.#.
......####
#.#.#.##..

Tile 1663:
..#..###.#
#...#.#..#
#...#.....
###..##...
..#.#.....
..........
#.#....##.
..#....###
#..#..#.#.
###.#.##..

'''

	return input
}
